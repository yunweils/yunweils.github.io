(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{337:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"版本和运行环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本和运行环境"}},[s._v("#")]),s._v(" 版本和运行环境")]),s._v(" "),a("ul",[a("li",[s._v("etcd版本：3.3.11")]),s._v(" "),a("li",[s._v("flanneld版本：0.7.1")]),s._v(" "),a("li",[s._v("运行环境：Centos7 64位")]),s._v(" "),a("li",[s._v("安装机器IP\n"),a("ul",[a("li",[s._v("节点1：192.168.0.183")]),s._v(" "),a("li",[s._v("节点2：192.168.0.141")]),s._v(" "),a("li",[s._v("节点3：192.168.0.66")])])])]),s._v(" "),a("h1",{attrs:{id:"下载地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载地址"}},[s._v("#")]),s._v(" 下载地址")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/etcd-io/etcd/archive/refs/tags/v3.3.11.tar.gz",target:"_blank",rel:"noopener noreferrer"}},[s._v("etcd v3.3.11"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://rpmfind.net/linux/centos/7.9.2009/extras/x86_64/Packages/flannel-0.7.1-4.el7.x86_64.rpm",target:"_blank",rel:"noopener noreferrer"}},[s._v("flanneld v0.7.1"),a("OutboundLink")],1)])]),s._v(" "),a("h1",{attrs:{id:"安装etcd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装etcd"}},[s._v("#")]),s._v(" 安装ETCD")]),s._v(" "),a("h2",{attrs:{id:"节点1安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点1安装"}},[s._v("#")]),s._v(" 节点1安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TOKEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-etcd-token\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER_STATE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("new\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-0\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-1\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-2\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.183\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.141\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.66\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_1}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_1}")]),s._v(":2380,"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_2}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_2}")]),s._v(":2380,"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_3}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_3}")]),s._v(":2380\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("THIS_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_1}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("THIS_IP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_1}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" /data/etcd/etcd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_NAME}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --data-dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data/etcd/etcd-data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --listen-client-urls http://0.0.0.0:2379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --advertise-client-urls http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_IP}")]),s._v(":2379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --listen-peer-urls http://0.0.0.0:2380 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-advertise-peer-urls http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_IP}")]),s._v(":2380 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CLUSTER}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster-token "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TOKEN}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster-state "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CLUSTER_STATE}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --log-level info "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--logger")]),s._v(" zap "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --log-outputs stderr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" etcd_nohup.out "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h2",{attrs:{id:"节点2安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点2安装"}},[s._v("#")]),s._v(" 节点2安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TOKEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-etcd-token\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER_STATE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("new\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-0\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-1\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-2\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.183\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.141\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.66 \n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_1}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_1}")]),s._v(":2380,"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_2}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_2}")]),s._v(":2380,"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_3}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_3}")]),s._v(":2380\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("THIS_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_2}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("THIS_IP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_2}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" /data/etcd/etcd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_NAME}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --data-dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data/etcd/etcd-data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --listen-client-urls http://0.0.0.0:2379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --advertise-client-urls http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_IP}")]),s._v(":2379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --listen-peer-urls http://0.0.0.0:2380 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-advertise-peer-urls http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_IP}")]),s._v(":2380 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CLUSTER}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster-token "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TOKEN}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster-state "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CLUSTER_STATE}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --log-level info "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--logger")]),s._v(" zap "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --log-outputs stderr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" etcd_nohup.out "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h2",{attrs:{id:"节点3安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点3安装"}},[s._v("#")]),s._v(" 节点3安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TOKEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("my-etcd-token\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER_STATE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("new\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-0\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-1\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME_3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("etcd-node-2\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.183\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.141\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOST_3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.66 \n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLUSTER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_1}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_1}")]),s._v(":2380,"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_2}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_2}")]),s._v(":2380,"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_3}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_3}")]),s._v(":2380\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("THIS_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NAME_3}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("THIS_IP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HOST_3}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" /data/etcd/etcd "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_NAME}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --data-dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/data/etcd/etcd-data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --listen-client-urls http://0.0.0.0:2379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --advertise-client-urls http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_IP}")]),s._v(":2379 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --listen-peer-urls http://0.0.0.0:2380 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-advertise-peer-urls http://"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${THIS_IP}")]),s._v(":2380 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CLUSTER}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster-token "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TOKEN}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --initial-cluster-state "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CLUSTER_STATE}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --log-level info "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--logger")]),s._v(" zap "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --log-outputs stderr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" etcd_nohup.out "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h1",{attrs:{id:"设置etcd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置etcd"}},[s._v("#")]),s._v(" 设置ETCD")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz9h329naauth1zvvk4qZ etcd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ./etcdctl set /coreos.com/network/config \'{ "network":"10.60.0.0/16" }\'')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"network"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.60.0.0/16"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz9h329naauth1zvvk4qZ etcd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./etcdctl get /coreos.com/network/config")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"network"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.60.0.0/16"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看etcd集群健康")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz9h329naauth1zvvk4qZ etcd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./etcdctl  cluster-health")]),s._v("\nmember 4e24fda0ab3bbfb is healthy: got healthy result from http://192.168.0.183:2379\nmember 32b3606bfa3a3376 is healthy: got healthy result from http://192.168.0.141:2379\nmember d6c8dc141c7fa6ac is healthy: got healthy result from http://192.168.0.66:2379\ncluster is healthy\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h1",{attrs:{id:"安装flannel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装flannel"}},[s._v("#")]),s._v(" 安装Flannel")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#etcd IP")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flannel_etcd_endpoints")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http\\:\\/\\/192.168.0.183\\:2379,http\\:\\/\\/192.168.0.141\\:2379,http\\:\\/\\/192.168.0.66\\:2379"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#etcd peizhi")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flannel_etcd_prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\/coreos.com\\/network"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#yum localinstall -y flannel*")]),s._v("\nyum localinstall "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" flannel*\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sleep 5")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/'")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FLANNEL_ETCD_ENDPOINTS\\=[^\\ \\]*"')]),s._v("'/"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\"FLANNEL_ETCD_ENDPOINTS\\=$flannel_etcd_endpoints\"'")]),s._v("/g"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("' /etc/sysconfig/flanneld\nsed -i '")]),s._v("s/"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\"FLANNEL_ETCD_PREFIX\\=[^\\ \\]*\"'")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\"FLANNEL_ETCD_PREFIX\\=$flannel_etcd_prefix\"'")]),s._v("/g' /etc/sysconfig/flanneld\n\nsystemctl start flanneld\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" flanneld\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);